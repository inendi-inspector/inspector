macro(declare_internal_library libname)
	string(TOUPPER ${libname} libname_upper)
	set(${libname_upper}_INCLUDE_DIRS "${CMAKE_CURRENT_SOURCE_DIR}/lib${libname}/src/include")
	add_subdirectory(lib${libname})
endmacro()

macro(declare_customer_cap cap default_dev default_customer)
	# Default value
	if (NOT DEFINED ${cap})
		if (PICVIZ_DEVELOPER_MODE)
			set(${cap} ${default_dev})
		else()
			set(${cap} ${default_customer})
		endif()
	endif()
endmacro()

macro(declare_pv_test target files libs)
	add_executable(${target} EXCLUDE_FROM_ALL ${files})
	target_link_libraries(${target} ${libs})
	add_dependencies(alltests ${target})
endmacro()

function(strcasecmp res str1 str2)
	string(TOLOWER ${str1} str1_lower)
	string(TOLOWER ${str2} str2_lower)
	string(COMPARE EQUAL str1_lower str2_lower res)
endfunction()
 
macro(PV_QT4_UI_INC_DIR res)
	set(${res} ${CMAKE_BINARY_DIR}/generated_ui_headers/)
endmacro()

macro(PV_QT4_UI_DIR res)
	PV_QT4_UI_INC_DIR(incdir)
	string(REPLACE "lib" "" PROJECT_NAME_NOLIB ${PROJECT_NAME})
	set(${res} ${incdir}/${PROJECT_NAME_NOLIB}/ui)
endmacro()

# Based on original QT4_WRAP_UI
MACRO (PV_QT4_WRAP_UI outfiles )
  QT4_EXTRACT_OPTIONS(ui_files ui_options ${ARGN})

  FOREACH (it ${ui_files})
    GET_FILENAME_COMPONENT(outfile ${it} NAME_WE)
    GET_FILENAME_COMPONENT(infile ${it} ABSOLUTE)
	PV_QT4_UI_DIR(outdir)
	file(MAKE_DIRECTORY ${outdir})
    SET(outfile ${outdir}/${outfile}.h)
    ADD_CUSTOM_COMMAND(OUTPUT ${outfile}
      COMMAND ${QT_UIC_EXECUTABLE}
      ARGS ${ui_options} -o ${outfile} ${infile}
      MAIN_DEPENDENCY ${infile} VERBATIM)
    SET(${outfiles} ${${outfiles}} ${outfile})
  ENDFOREACH (it)
ENDMACRO() 
